<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="../../css/jquery/jquery.flexigrid.css?v=1.0.1">
    <link rel="stylesheet" href="../../css/jquery/jquery.alerts.css?v=1.0.1">
    <base href="./">
	<title>条码盒管理</title>
</head>
<body>
	<form action="../../data/listBarcodeBoxes" method="get">
		<table class="searchTable">
			<tbody>
				<tr>
					<td>条码盒编号</td>
  					<td style="padding-left:10px">
  						<input type="text" name="" value="">-
  						<input type="text" name="" value="">
  					</td>
  					<td>公司名称</td>
  					<td style="padding-left:10px">
  						<select name="">
  							<option value=""></option>
  						</select>
  					</td>
  					<td>产品名称</td>
  					<td style="padding-left:10px">
  						<select name="">
  							<option value=""></option>
  						</select>
  					</td>
  					<td>打包时间</td>
  					<td style="padding-left:10px">
  						<input id="startTime" type="text" class="Wdate" style="width: 100px;" onFocus="WdatePicker({lang:'zh-cn',readOnly:true,maxDate:'#F{$dp.$D(\'endTime\')}'})"/>至
  						<input id="endTime" type="text" class="Wdate" style="width: 100px;" onFocus="WdatePicker({lang:'zh-cn',readOnly:true,minDate:'#F{$dp.$D(\'startTime\')}'})"/>
  					</td>				
  				</tr>
			</tbody>
		</table>
	</form>
	<table class="listTable"></table>

	<script src="../../js/jquery/jquery-1.8.3.min.js?v=1.0.1"></script>
	<script src="../../js/jquery/jquery.flexigrid.js?v=1.0.1"></script>
	<script src="../../plugins/My97DatePicker/WdatePicker.js?v=1.0.1"></script>
	<script src="../../js/jquery/jquery.alerts.js?v=1.0.1"></script>
	<script>
	$(function(){
		$("table.listTable").flexigrid(GRID);	
	});	
	var GRID = {
		form: $("form"),
        //sortname: "",
        //sortorder: "",
        primaryKey: "id",
        colModel: [
        	{display: "条码盒编码", name: "packingCode", width: "22.5%", sortable: true},
			{display: "打包时间", name: "packingTime", width: "22.5%", sortable: true},
			{display: "公司名称", name: "orgName", width: "22.5%", sortable: true},
			{display: "产品名称", name: "productName", width: "22.5%", sortable: true},
			{display: "操作", name: "id", width: "10%", sortable: true,
				dataFormat: function(value, td, row){
					var oper = '';
            		oper += '<span class="detailBtn rowBtn" title="查看" onclick="rowDetail(this)"></span>';
            		oper += '<span class="deletesBtn rowBtn" title="作废" onclick="rowDelete(this)"></span>';
					return oper;
				}
			}
        ],
        add: {
        	url: "../html/label/listBarcodeBoxesItem.html",
        },
        deletes: {
        	url : "",
			primaryKey: "id"
        },
        buttons:[{
            name: "勾选打印条码",
            bclass: "printBtn",
            onpress: function(g){
                checkPrint({
                    url: "",
                    primaryKey: "id",
                    success : function() {},
                    error : function() {}
                },g);
            }
        },{
            name: "批量打印条码",
            bclass: "printBtn",
            onpress: function(g){
                execute({
                    url: "../html/label/listBarcodeBoxesPrint.html",
                    name: "批量打印条码",
                    success : function() {},
                    error : function() {}
                },g);
            }
        }]
	};


	function rowDetail(obj){
		executeRow({
        	url: "../html/label/listBarcodeBoxesItem.html?type=detail",
        	primaryKey: "id",
        	name: "查看条码盒信息"
		}, obj);
	}

	function rowDelete(obj){
		deletes(GRID.deletes, obj, true);
	}
	function checkPrint(jsonObj, g) {
		var tr = $(g.bDiv).find("tr.trSelected");
		if (tr.length > 0) {
			jConfirm("确定要打印所选择的条码吗？", "警告信息", function(r) {
			if (r) {
				var url = jsonObj.url;
				if (url.indexOf("?") > 0) {
					url += "&time=" + new Date().getTime();
				} else {
					url += "?time=" + new Date().getTime();
				}
				tr.each(
						function() {
							url += "&" + jsonObj.primaryKey + "="
									+ $(this).attr("PRIMARYKEY");
						});
				return;
				$.ajax( {
					type : 'post',
					url : url,
					dataType : 'json',
					success : function(json) {
						jsonObj.success(json);
						$(".listTable").flexReload( {});
					},
					error : function(XMLHttpRequest, json) {
						jsonObj.error(json);
					}
				});
			}
		});
		} else {
			jAlert("请选择你要操作的记录!");
		}
	}

	function batchPrint(jsonObj, g){
		edit(jsonObj, g);
	}
	</script>
</body>
</html>

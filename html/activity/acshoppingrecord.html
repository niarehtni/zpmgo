<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="../../css/jquery/jquery.flexigrid.css?v=1.0.1">
    <link rel="stylesheet" href="../../css/jquery/jquery.alerts.css?v=1.0.1">
    <base href="./">
    <title>消费记录列表</title>
</head>
<body>
<form action="../../data/acshoppingrecord" method="get">
    <table class="searchTable">
        <tbody>
        <tr>
            <td>所属公司</td>
            <td style="padding-left: 10px;">
                <select name="">
                    <option value=""></option>
                    <option value="">公司A</option>
                </select>
            </td>
            <td>门店</td>
            <td style="padding-left: 10px;">
                <select name="" id="">
                    <option value=""></option>
                </select>
            </td>
            <td>消费记录状态</td>
            <td style="padding-left: 10px;">
                <select name="">
                    <option value="">请选择</option>
                    <option value="0">购买</option>
                    <option value="1">兑换</option>
                </select>
            </td>
            <td>推荐人</td>
            <td style="padding-left: 10px;">
                <select name="">
                    <option value=""></option>
                </select>
            </td>
        </tr>
        </tbody>
    </table>
</form>
<table class="listTable"></table>

<script src="../../js/jquery/jquery-1.8.3.min.js?v=1.0.1"></script>
<script src="../../js/jquery/jquery.flexigrid.js?v=1.0.1"></script>
<script src="../../js/jquery/jquery.alerts.js?v=1.0.1"></script>
<script>
    $(function(){
        $("table.listTable").flexigrid(GRID);
    });
    var GRID = {
        form: $("form"),
        //sortname: "",
        //sortorder: "",
        primaryKey: "id",
        showCheckBox: false,
        singleSelect: true,
        colModel: [
            {display: "公司", name: "orgName", width: "15%", sortable: true},
            {display: "门店", name: "posName", width: "15%", sortable: true},
            {display: "产品", name: "productName", width: "15%", sortable: true},
            {display: "物流码", name: "transCode", width: "15%", sortable: true,},
            {display: "推荐人", name: "recommenderName", width: "15%", sortable: true},
            {display: "价格", name: "price", width: "15%", sortable: true},
            {display: "消费状态", name: "shoppingStatus", width: "5%", sortable: true,
                dataFormat:function (value, td, row) {
                    return 1 == value ? '兑换' : '购买';
                }
            },
            {display: "操作", name: "id", width: "5%", sortable: true,
                dataFormat: function(value, td, row){
                    return '<span class="detailBtn rowBtn" title="查看" onclick="rowDetail(this)"></span>';
                }
            }
        ]
    };

    function rowDetail(obj){
        var tr = $(obj).parents("tr");
        var url = "../html/activity/acshoppingrecordItem.html?type=detail";
        url += "&orgName="+tr.find("[abbr='orgName']").text();
        url += "&shoppingStatus="+tr.find("[abbr='shoppingStatus']").text();
        url += "&posName="+tr.find("[abbr='posName']").text();
        url += "&transCode="+tr.find("[abbr='transCode']").text();
        url += "&recommenderName="+tr.find("[abbr='recommenderName']").text();
        url += "&price="+tr.find("[abbr='price']").text();
        detail({
            url:url,
            primaryKey: "id",
            name: "消费记录"
        }, obj, true);
    }
</script>
</body>
</html>

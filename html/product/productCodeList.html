<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <link rel="stylesheet" href="../../css/jquery/jquery.flexigrid.css?v=1.0.1">
    <link rel="stylesheet" href="../../css/jquery/jquery.alerts.css?v=1.0.1">
    <base href="./">
	<title>产品码列表</title>
</head>
<body>
	<form action="../../data/productCodeList" method="get">
		<table class="searchTable">
			<tbody>
				<tr>
					<td>公司</td>
  					<td style="padding-left:10px">
  						<select name="">
  							<option value=""></option>
                            <option value="">公司A</option>
  						</select>
  					</td>
  					<td>商品条码:</td>
  					<td style="padding-left:10px">
  						<input type="text" name="">
  					</td>
  					<td>使用状态</td>
  					<td style="padding-left:10px">
  						<select name="">
                            <option value=""></option>
  							<option value="已使用">已使用</option>
                            <option value="未使用">未使用</option>
  						</select>
  					</td>			
  				</tr>
			</tbody>
		</table>
	</form>
	<table class="listTable"></table>

	<script src="../../js/jquery/jquery-1.8.3.min.js?v=1.0.1"></script>
	<script src="../../js/jquery/jquery.flexigrid.js?v=1.0.1"></script>
	<script src="../../js/jquery/jquery.alerts.js?v=1.0.1"></script>
	<script>
	$(function(){
		$("table.listTable").flexigrid(GRID);	
	});	
	var GRID = {
		form: $("form"),
        //sortname: "",
        //sortorder: "",
        primaryKey: "id",
        colModel: [
            {display: "公司", name: "orgName", width: 180, sortable: true},
			{display: "商品条码", name: "standard", width: 180, sortable: true},
			{display: "产品名称", name: "publishProductName", width: 180, sortable: true},
			{display: "使用状态", name: "name", width: 60, sortable: true,
                dataFormat: function(value, td, row){
                    if(row.publishProductName == null){
                        return "未使用";
                    }
                    return "已使用";
                }
            },
			{display: "状态", name: "status", width: 150, sortable: true},
			{display: "操作", name: "id", width: 80, sortable: true,
				dataFormat: function(value, td, row){
					var oper = '';
            		oper += '<span class="detailBtn rowBtn" title="查看" onclick="rowDetail(this)"></span>';
            		oper += '<span class="deletesBtn rowBtn" title="删除" onclick="rowDelete(this)"></span>';
                    oper += '<span class="printBtn rowBtn" title="打印" onclick="print(this)"></span>'
					return oper;
				}
			}
        ],
        add: {
        	url: "../html/product/productCodeList.html",
        },
        detail: {
        	url: "../html/product/productCodeList.html?type=detail",
        	primaryKey: "id",
        },
        deletes: {
        	url : "",
    	    primaryKey: "id"
        },
        buttons:[{
            name: "上传",
            bclass: "uploadBtn",
            onpress: function(g){
                upload({
                    url: "../html/product/productCodeListUpload.html",
                    primaryKey: "id",
                    name: "产品码上传",
                    success : function() {},
                    error : function() {}
                },g);
            }
        }]
	};

	function rowDetail(obj){
		detail(GRID.detail, obj, true);
	}

	function rowDelete(obj){
		deletes(GRID.deletes, obj, true);
	}

    function print(obj){
        alert("功能预留");
    }

    function upload(jsonObj, g) {
        jsonObj = $.extend( {
            url : false,
            width : false,
            height : false,
            primaryKey : false,
        }, jsonObj);
        var url = jsonObj.url;
        if (url.indexOf("?") > 0) {
            url = url + "&time=" + new Date().getTime();
        } else {
            url = url + "?time=" + new Date().getTime();
        }
        
        top.addTab({href:url,name:jsonObj.name,closeCallBack:function(result){
            if(result.code == "200"){
                jsonObj.success();
                $(".listTable").flexReload( {});
            }else{
                jsonObj.error();
            }
        },closeCheckBefore:function(){return confirm("是否确定关闭？")}});
    }
	</script>
</body>
</html>
